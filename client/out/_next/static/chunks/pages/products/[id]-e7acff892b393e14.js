(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{8693:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products/[id]",function(){return n(7905)}])},8675:function(t,e,n){"use strict";n.d(e,{G2:function(){return l},Ys:function(){return s},Yw:function(){return d},iq:function(){return m}});var r=n(2729),o=n(8806);function i(){let t=(0,r._)(["\n  mutation loginUser($name: String!, $phoneNumber: String!, $password: String!) {\n    loginUser(name: $name, phoneNumber: $phoneNumber, password: $password) {\n      token,\n      expirationTime\n    }\n}\n"]);return i=function(){return t},t}function u(){let t=(0,r._)(["\n  mutation AddToCart($productId: ID!, $phoneNumber: String!) {\n    addToCart(productId: $productId, phoneNumber: $phoneNumber)\n  }\n"]);return u=function(){return t},t}function a(){let t=(0,r._)(["\n  mutation DeleteFromCart($productId: ID!, $phoneNumber: String!) {\n    deleteFromCart(productId: $productId, phoneNumber: $phoneNumber)\n  }\n"]);return a=function(){return t},t}function c(){let t=(0,r._)(["\n  mutation PlaceOrder($phoneNumber: String!) {\n    placeOrder(phoneNumber: $phoneNumber) \n  }\n"]);return c=function(){return t},t}let s=(0,o.Ps)(i()),l=(0,o.Ps)(u()),d=(0,o.Ps)(a()),m=(0,o.Ps)(c())},7905:function(t,e,n){"use strict";n.r(e),n.d(e,{__N_SSG:function(){return d},default:function(){return m}});var r=n(5893),o=n(7294);n(5675);var i=n(1163);function u(t){return(0,r.jsx)("div",{style:{height:"50px"},children:t.alert&&(0,r.jsx)("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:t.alert.msg})})}var a=n(319),c=n(8675),s=n(6748);function l(t){let{product:e}=t,[n,l]=(0,o.useState)(null),[d,m]=(0,o.useState)(!1),[h,p]=(0,o.useState)(null),{id:f}=(0,i.useRouter)().query,{theme:g}=(0,s.F)(),[v]=(0,a.D)(c.G2);(0,o.useEffect)(()=>{let t=localStorage.getItem("token"),e=localStorage.getItem("expirationTime");p(localStorage.getItem("phoneNumber")),t&&e?e<Date.now()?m(!1):m(!0):m(!1)},[]);let N=async()=>{if(d)try{let{data:t}=await v({variables:{productId:f,phoneNumber:h}});console.log("Product added to cart:",t),x("Successfully added to your shopping cart!")}catch(t){console.error("Error adding product to cart:",t)}else x("Login to add an item to your cart!")},x=t=>{l({msg:t}),setTimeout(()=>{l(null)},1500)};return(0,r.jsxs)("section",{className:"py-5",style:{backgroundColor:"light"===g?"white":"#131313",height:"100vh",color:"light"===g?"black":"white"},children:[(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)("div",{className:"row gx-5",children:[(0,r.jsx)("aside",{className:"col-lg-6",children:(0,r.jsx)("div",{className:"border rounded-4 mb-3 d-flex justify-content-center",children:(0,r.jsx)("img",{src:e.image,alt:e.name,style:{maxWidth:"100%",maxHeight:"100vh",margin:"auto"},className:"rounded-4 fit",loading:"lazy"})})}),(0,r.jsx)("main",{className:"col-lg-6",children:(0,r.jsxs)("div",{className:"ps-lg-3",children:[(0,r.jsx)("h4",{className:"title text-".concat("dark"===g?"light":"dark"),children:e.name}),(0,r.jsx)("div",{className:"d-flex flex-row my-3",children:(0,r.jsx)("div",{className:"text-warning mb-1 me-2",children:(0,r.jsxs)("span",{className:"ms-1",children:[e.avgRating,"⭐"]})})}),(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsxs)("span",{className:"h5",children:["$",e.price]})}),(0,r.jsx)("p",{children:e.description}),(0,r.jsx)("hr",{}),(0,r.jsx)("button",{onClick:N,className:"btn btn-primary shadow-0",children:"Add to Cart"})]})})]})}),(0,r.jsx)(u,{alert:n})]})}var d=!0;function m(t){let{product:e}=t;return(0,r.jsx)(l,{product:e})}},319:function(t,e,n){"use strict";n.d(e,{D:function(){return l}});var r=n(7582),o=n(3914),i=n(4012),u=n(20),a=n(4692),c=n(990),s=n(6252);function l(t,e){var n=(0,s.x)(null==e?void 0:e.client);(0,a.Vp)(t,a.n_.Mutation);var l=o.useState({called:!1,loading:!1,client:n}),d=l[0],m=l[1],h=o.useRef({result:d,mutationId:0,isMounted:!0,client:n,mutation:t,options:e});Object.assign(h.current,{client:n,options:e,mutation:t});var p=o.useCallback(function(t){void 0===t&&(t={});var e=h.current,n=e.options,o=e.mutation,a=(0,r.pi)((0,r.pi)({},n),{mutation:o}),s=t.client||h.current.client;h.current.result.loading||a.ignoreResults||!h.current.isMounted||m(h.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:s});var l=++h.current.mutationId,d=(0,i.J)(a,t);return s.mutate(d).then(function(e){var n,r,o=e.data,i=e.errors,a=i&&i.length>0?new c.cA({graphQLErrors:i}):void 0,p=t.onError||(null===(n=h.current.options)||void 0===n?void 0:n.onError);if(a&&p&&p(a,d),l===h.current.mutationId&&!d.ignoreResults){var f={called:!0,loading:!1,data:o,error:a,client:s};h.current.isMounted&&!(0,u.D)(h.current.result,f)&&m(h.current.result=f)}var g=t.onCompleted||(null===(r=h.current.options)||void 0===r?void 0:r.onCompleted);return a||null==g||g(e.data,d),e}).catch(function(e){if(l===h.current.mutationId&&h.current.isMounted){var n,r={loading:!1,error:e,data:void 0,called:!0,client:s};(0,u.D)(h.current.result,r)||m(h.current.result=r)}var o=t.onError||(null===(n=h.current.options)||void 0===n?void 0:n.onError);if(o)return o(e,d),{data:void 0,errors:e};throw e})},[]),f=o.useCallback(function(){if(h.current.isMounted){var t={called:!1,loading:!1,client:n};Object.assign(h.current,{mutationId:0,result:t}),m(t)}},[]);return o.useEffect(function(){return h.current.isMounted=!0,function(){h.current.isMounted=!1}},[]),[p,(0,r.pi)({reset:f},d)]}}},function(t){t.O(0,[51,675,888,774,179],function(){return t(t.s=8693)}),_N_E=t.O()}]);